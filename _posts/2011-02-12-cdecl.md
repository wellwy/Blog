---
layout: post_m
title:  "_cdecl __fastcall与 __stdcall区别"
date:   2011-02-12 16:05:55
categories: Win32
summary:  
src :  
---


`__cdecl` `__fastcall`与 `__stdcall`，三者都是调用约定(Calling convention)，它决定以下内容：1)函数参数的压栈顺序，2)由调用者还是被调用者把参数弹出栈，3)以及产生函数修饰名的方法。
 
1. `__stdcall`调用约定：函数的参数自右向左通过栈传递，被调用的函数在返回前清理传送参数的内存栈，
2. `_cdecl`是C和C＋＋程序的缺省调用方式。每一个调用它的函数都包含清空堆栈的代码，所以产生的可执行文件大小会比调用`_stdcall`函数的大。函数采用从右到左的压栈方式。注意：对于可变参数的成员函数，始终使用`__cdecl`的转换方式。
3. `__fastcall`调用约定：它是通过寄存器来传送参数的（实际上，它用ECX和EDX传送前两个双字（DWORD）或更小的参数，剩下的参数仍旧自右向左压栈传送，被调用的函数在返回前清理传送参数的内存栈）。
4. `thiscall`仅仅应用于"C++"成员函数。this指针存放于CX寄存器，参数从右到左压。thiscall不是关键词，因此不能被程序员指定。
5. `nakedcall`采用1-4的调用约定时，如果必要的话，进入函数时编译器会产生代码来保存ESI，EDI，EBX，EBP寄存器，退出函数时则产生代码恢复这些寄存器的内容。naked call不产生这样的代码。naked call不是类型修饰符，故必须和_declspec共同使用。