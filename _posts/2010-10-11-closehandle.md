---
layout: post_m
title:  "线程的CloseHandle"
date:   2010-10-11 11:27
categories: win32
description:  
src : http://blog.csdn.net/apple_operation/archive/2007/09/12/1782239.aspx 
---


##线程的handle用处:

线程的handle是指向“线程的内核对象”的，而不是指向线程本身.每个内核对象只是内核分配的一个内存块，并且只能由内核访问。该内存块是一种数据结构，它的成员负责维护对象的各种信息（eg: 安全性描述，引用计数等）。

##CloseHandle()作用

在CreateThread成功之后会返回一个hThread的handle，且内核对象的计数加1，CloseHandle之后，引用计数减1，当变为0时，系统删除内核对象。

但是这个handle并不能完全代表这个线程，它仅仅是线程的一个“标识”，系统和用户可以利用它对相应的线程进行必要的操纵。如果在线程成功创建后，不再需要用到这个句柄，就可以在创建成功后，线程退出前直接CloseHandle掉，但这并不会影响到线程的运行。

##不执行CloseHandle() 带来的后果

若在线程执行完之后，没有通过CloseHandle（）将引用计数减1，在进程执行期间，将会造成内核对象的泄露，相当与句柄泄露，但不同于内存泄露，这势必会对系统的效率带来一定程度上的负面影响。但是，请记住，当进程结束退出后，系统仍然会自动帮你清理这些资源。但是在这里不推荐这种做法，毕竟不是一个良好的编程习惯！呵呵！